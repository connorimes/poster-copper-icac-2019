%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% a0poster Portrait Poster
% LaTeX Template
% Version 1.0 (22/06/13)
%
% The a0poster class was created by:
% Gerlinde Kettl and Matthias Weiser (tex@kettl.de)
% 
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[a0,portrait]{a0poster}

% increase some sizes
\renewcommand{\footnotesize}{\fontsize{20.74}{25}\selectfont}
\renewcommand{\small}{\fontsize{24.88}{30}\selectfont}
\renewcommand{\normalsize}{\fontsize{29.86}{37}\selectfont}

\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage{multicol} % This is so we can have multiple columns of text side-by-side
\columnsep=100pt % This is the amount of white space between the columns in the poster
\columnseprule=1pt % This is the thickness of the black line between the columns in the poster

\usepackage[svgnames]{xcolor} % Specify colors by their 'svgnames', for a full list of all colors available see here: http://www.latextemplates.com/svgnames-colors

\usepackage{tikz}
\usepackage{pgfplots}
% options for pgfplots
\pgfplotsset{compat=1.8,compat/show suggested version=false}
\usetikzlibrary{calc,trees,arrows,patterns,plotmarks,shapes,snakes,er,3d,automata,backgrounds,topaths,decorations.pathmorphing,decorations.markings}
%\pgfplotsset{compat=newest}
\pgfplotsset{
   /pgfplots/bar  cycle  list/.style={/pgfplots/cycle  list={%
        {black,fill=black!30!white,mark=none},%
        {black,fill=red!30!white,mark=none},%
        {black,fill=green!30!white,mark=none},%
        {black,fill=yellow!30!white,mark=none},%
        {black,fill=brown!30!white,mark=none},%
     }
   },
}
% begin of externalization
\usetikzlibrary{external}
\tikzexternalize[prefix=out/]
\tikzexternalize
% don't externalize todonotes
%\makeatletter
%\renewcommand{\todo}[2][]{\tikzexternaldisable\@todo[#1]{#2}\tikzexternalenable}
%\makeatother
% end of externalization
\usepgfplotslibrary{groupplots}
\pgfplotsset{
every axis label/.append style={font=\normalsize},
tick label style={font=\small},
}
\usepackage{times} % Use the times font
%\usepackage{palatino} % Uncomment to use the Palatino font

\usepackage{graphicx} % Required for including images
%\graphicspath{{figures/}} % Location of the graphics files
\usepackage{booktabs} % Top and bottom rules for table
\usepackage[font=normalsize,labelfont=bf]{caption} % Required for specifying captions to tables and figures
\usepackage{amsfonts, amsmath, amsthm, amssymb} % For math fonts, symbols and environments
\usepackage{wrapfig} % Allows wrapping text around tables and figures
\usepackage{subcaption}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\usepackage{listings}
\lstset{ %
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\ttfamily, % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  frame=leftline,                  % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
  morekeywords={*,...},            % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=10pt,                   % how far the line-numbers are from the code
  numberstyle=\small\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{black},     % string literal style
  tabsize=1,                       % sets default tabsize to 2 spaces
  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}

% some useful shortcuts
\newcommand{\ie}{\textit{i.e., }}
\newcommand{\eg}{\textit{e.g., }}
\newcommand{\etal}{et al.\ }
\newcommand{\CC}{C\nolinebreak\hspace{-.05em}\raisebox{.5ex}{\tiny\bf +}\nolinebreak\hspace{-.10em}\raisebox{.5ex}{\tiny\bf +}}

% units for results
\newcommand{\uj}{\,$\mu$J}
\newcommand{\mw}{\,mW}
\newcommand{\uw}{\,$\mu$W}
\newcommand{\ns}{\,ns}
\newcommand{\us}{\,$\mu$s}
\newcommand{\ms}{\,ms}
\newcommand{\KB}{\,KB}
\newcommand{\MB}{\,MB}
\newcommand{\GB}{\,GB}
\newcommand{\MHz}{\,MHz}
\newcommand{\GHz}{\,GHz}

\newcommand{\SYSTEM}{CoPPer}
% \newcommand{\system}{bard}
% new latex commands:
%   Remove long section
\newcommand{\PUNT}[1]{}

%   Referencing various pieces of the document:
\newcommand{\figref}[1]{Figure~\ref{fig:#1}}
\newcommand{\figsref}[2]{Figures~\ref{fig:#1} and~\ref{fig:#2}}
\newcommand{\figrref}[2]{Figures~\ref{fig:#1}--\ref{fig:#2}}
\newcommand{\secref}[1]{Section~\ref{sec:#1}}
\newcommand{\secsref}[2]{Sections~\ref{sec:#1} and~\ref{sec:#2}}
\newcommand{\eqnref}[1]{Eqn.~\ref{eqn:#1}}
\newcommand{\eqnsref}[2]{Eqns.~\ref{eqn:#1} and~\ref{eqn:#2}}
\newcommand{\eqnrref}[2]{Eqns.~\ref{eqn:#1}--\ref{eqn:#2}}
\newcommand{\insref}[1]{Instruction~\ref{ins:#1}}
\newcommand{\tblref}[1]{Table~\ref{tbl:#1}}
\newcommand{\appref}[1]{Appendix~\ref{app:#1}}
\newcommand{\algoref}[1]{Algorithm~\ref{algo:#1}}

\newcommand{\argmin}{\arg\!\min}
\newcommand{\argmax}{\arg\!\max}
\newcommand{\minimize}{minimize}
\newcommand{\optimize}{optimize}
\newcommand{\st}{s.t.}

\newcommand{\app}[1]{\mbox{\texttt{#1}}}
\newcommand{\interface}[1]{\textbf{#1}}
\newcommand{\function}[1]{\mbox{\texttt{#1}}}
\newcommand{\struct}[1]{\emph{#1}}
\newcommand{\variable}[1]{\emph{#1}}

\newcommand{\PAD}{\vskip 0.75cm}

\usepackage[natbib=true,backend=bibtex,firstinits=true,style=numeric-comp,sorting=nyt,defernumbers,maxnames=2,maxcitenames=2,doi=false,isbn=false,url=false]{biblatex}
\bibliography{seec}

% Use bold for vectors instead of arrows
\renewcommand{\vec}[1]{\mathbf{#1}}

% Because the default settings for a0poster leave way too much whitespace!
\setlength{\topmargin}{3 cm}
\setlength{\oddsidemargin}{3 cm}
\addtolength{\textwidth}{3cm}
\addtolength{\textheight}{4cm}

\begin{document}

%----------------------------------------------------------------------------------------
%	POSTER HEADER 
%----------------------------------------------------------------------------------------

\begin{minipage}[b]{\linewidth}
\begin{center}
\includegraphics[height=5cm]{figures/uchicago_logo.png} %[width=20cm]
\hspace{40cm}
\includegraphics[height=5cm]{figures/isi_logo.png}\\
\vspace{0.25cm}
\noindent\makebox[\linewidth]{\rule{0.9\paperwidth}{0.4pt}}
\vspace{0.25cm}
\end{center}

\Huge \color{NavyBlue} \textbf{CoPPer: Soft Real-time Application Performance Using Hardware Power Capping} \color{Black}\\[0.5cm] % Title
% \veryHuge \color{NavyBlue} \textbf{Bard} \color{Black}\\[0.5cm] % Title
% \Huge\textit{A Unified Framework for Managing Soft Timing and Power Constraints}\\[1.5cm] % Subtitle
%\begin{center}
\huge \textbf{Connor Imes$^*$, Huazhe Zhang, Kevin Zhao$^{**}$, and Henry Hoffmann}\\[0.25cm] % Author(s)
\LARGE \textbf{University of Chicago, USC Information Sciences Institute$^*$, University of Washington$^{**}$}\\ % University/organization
\Large \textbf{ckimes@cs.uchicago.edu, huazhe@cs.uchicago.edu, kzhao@uchicago.edu, hankhoffmann@cs.uchicago.edu}
% \\
%\end{center}
\end{minipage}
%

%\vspace{1cm} % A bit of extra whitespace between the header and poster content

%----------------------------------------------------------------------------------------

\begin{multicols}{2} % This is how many columns your poster will be broken into, a portrait poster is generally split into 2 columns

%----------------------------------------------------------------------------------------
%	ABSTRACT
%----------------------------------------------------------------------------------------

\color{Navy} % Navy color for the abstract

\begin{abstract}

\large
\textbf{Dynamic voltage and frequency scaling (DVFS)} has been the cornerstone of innumerable software approaches to meeting application timing requirements with minimal energy.
However, recent trends in technology favor hardware control of DVFS, as hardware can both react faster to external events and perform fine-grained power management across a device.
We respond to these trends with \textbf{\SYSTEM{}}, which instead uses \textbf{hardware power capping} to meet application performance requirements with high energy efficiency.
Meeting performance requirements with power capping is more challenging than using DVFS because the relationship between power and performance is non-linear ($P \propto CV^2f$).
\SYSTEM{} overcomes these difficulties by using \textbf{adaptive control} to approximate non-linearities and a novel \textbf{gain limit} to avoid over-allocating power when it is no longer beneficial.
\SYSTEM{} provides all the functionality of a sophisticated DVFS-based approach, without requiring a user-specified model or time-consuming, exhaustive application/system pre-characterization.
Compared to DVFS, \SYSTEM{}'s gain limit reduces energy by 6\% on average and by 12\% for memory-bound applications.
For high performance requirements, the energy savings are even greater: 8\% on average and 18\% for memory-bound applications.

\end{abstract}

%----------------------------------------------------------------------------------------
%	INTRODUCTION
%----------------------------------------------------------------------------------------

%\color{SaddleBrown} % SaddleBrown color for the introduction

%\section*{Introduction}

%----------------------------------------------------------------------------------------
%	OBJECTIVES
%----------------------------------------------------------------------------------------

\color{DarkSlateGray} % DarkSlateGray color for the rest of the content

% \vspace{-1cm}
% \section*{Motivation}


%----------------------------------------------------------------------------------------
%	MATERIALS AND METHODS
%----------------------------------------------------------------------------------------

\vspace{-1.5cm}
\section*{DVFS vs. Power Capping}

{
\PAD
\centering
  \begin{minipage}{.5\linewidth}
    \centering
    \input{img/tradeoffs-vips-dvfs.tex}%
    \captionof{figure}{DVFS peformance impact.}
    \label{fig:tradeoffs-vips-dvfs}
  \end{minipage}
  \begin{minipage}{.5\linewidth}
    \centering
    \input{img/tradeoffs-vips-pwr.tex}%
    \captionof{figure}{Power cap peformance impact.}
    \label{fig:tradeoffs-vips-pwr}
  \end{minipage}
}

For compute-bound applications (\eg \app{vips}), DVFS produces a linear response in performance, but power capping is \emph{non-linear}.
% Power capping has \emph{diminishing returns}: as power increases, the change in performance becomes smaller.
We demonstrate the challenge by meeting a performance goal in \app{vips} using a controller based on a linear DVFS model and two power capping controllers (one conservative and one aggressive) based on fitting time-invariant linear models (a textbook control-theoretic technique):
{
\PAD
\centering
  \input{img/VIPS-example.tex}
  \captionof{figure}{DVFS and power capping with linear models.}
  \label{fig:vips-example}
\PAD
}
The DVFS controller quickly reaches the desired performance.
The conservative power capping approach never violates the performance requirement, but its much slower reaction wastes energy.
The aggressive approach overreacts, oscillating around the performance target instead of settling on it.


% \vfill\null
% \columnbreak

%------------------------------------------------

%\subsection*{Mathematical Section}



%----------------------------------------------------------------------------------------
% RESULTS 
%----------------------------------------------------------------------------------------

\vspace{-1cm}
\section*{A General Power Capping Design}

We address the challenges above with \SYSTEM{}, which uses \emph{adaptive control}.

{
\PAD
\centering
  \input{img/scheme.tex}
  \captionof{figure}{\interface{CoPPer} feedback control design.}
  \label{fig:runtime}
\PAD
}

A user provides \SYSTEM{} with the \textbf{performance goal}, $P_{ref}$.
At runtime, the application measures its own performance (\textbf{performance feedback}), $p_m(t)$, which it provides to \SYSTEM{}.
The \textbf{min and max power caps}, $U_{min}$ and $U_{max}$, are system properties.

The \textbf{controller} first computes the \textbf{performance error}, followed by a \emph{speedup} value:
\begin{eqnarray}
  e(t) = P_{ref} - p_m(t)
  \label{eqn:error} \\
  s(t) = gain(t) \cdot \left(s(t-1) + \frac{e(t)}{b(t)}\right)
  \label{eqn:speedup-control}
\end{eqnarray}
where $s(t-1)$ is the speedup signal generated in the previous
iteration, $b(t)$ is the base speed estimate produced by a Kalmanf
filter, and $gain(t)$ (where $0 < gain(t) \le 1$) is a time-varying
value that scales the control response.
Finally, the new \textbf{power cap} to be applied is computed as:
\begin{eqnarray}
  u(t) = U_{min} \cdot s(t)
  \label{eqn:new-powercap}
\end{eqnarray}
Intuitively, if the performance error value computed in \eqnref{error} is low, then the system
has converged to the performance target and the speedup signal should
remain where it is.  However, if error values are high but the
\emph{difference} in error values between iterations is low, the controller
has settled, but the performance target is not achievable.  It
may then be beneficial to reduce the speedup, and thus power, by setting gain to:
\begin{eqnarray}
  gain(t) = 1 - \alpha_c \cdot e_{ns}(t) \cdot \Delta e_{ns}(t)
  \label{eqn:cost-pole}
\end{eqnarray}
where $\alpha_c$ ($0 \le \alpha_c < 1$) is the \emph{gain limit}, a
constant that controls how low the gain can go.
See the paper for more details about the gain and evaluation of unachievable goals.

To use \SYSTEM{}, the \function{copper\_adapt} function is called after each window period with an identifier and the current application performance.
This function returns the new power cap, which is then applied to the system:

\begin{figure}[H]
\small
\begin{minipage}[t]{.95\columnwidth}
\lstset{emph={%  
    copper_init, copper_adapt, apply_powercap%
    },emphstyle={\color{black}\bfseries\underbar}%
}%
\begin{lstlisting}[language=C,%
  caption={Using \SYSTEM{} to compute and apply power caps.},%
  morekeywords={uint64_t, uint32_t, hbsc_ctx, raplcap, raplcap_limit, copper},%
  label={lst:example-copper}]%

// initialize CoPPer
copper cop;
copper_init(&cop, perf_goal, pwr_min, pwr_max, pwr_start);
// application main loop
for (i = 1; i <= NUM_LOOPS; i++) {
  do_application_work();
  if (i % window_size == 0) {
    // end of window period
    perf = get_window_performance();
    powercap = copper_adapt(&cop, i, perf);
    apply_powercap(powercap);
  }
}
\end{lstlisting}
\end{minipage}
\end{figure}

% To apply RAPL power caps, we provide an easy-to-use tool called \app{RAPLCap}:

% \begin{figure}[H]
% \small
% \begin{minipage}[t]{.95\columnwidth}
% \lstset{emph={%  
%     raplcap_get_num_sockets, raplcap_set_limits%
%     },emphstyle={\color{black}\bfseries\underbar}%
% }%
% \begin{lstlisting}[language=C,%
%   caption={Applying a power cap with RAPLCap},%
%   morekeywords={uint32_t, raplcap, raplcap_limit},%
%   label={lst:example-powercap}]%

% raplcap rc;

% void apply_powercap(double powercap) {
%   uint32_t n = raplcap_get_num_sockets(&rc);
%   raplcap_limit rl = {
%     // time window = 0 keeps current time window
%     .seconds = 0.0,
%     // share computed power cap evenly
%     .watts = powercap / (double) n
%   };
%   for (uint32_t i = 0; i < n; i++) {
%     raplcap_set_limits(i, &rc, RAPLCAP_ZONE_PACKAGE, NULL, &rl);
%   }
% }
% \end{lstlisting}
% \end{minipage}
% % \caption{Using \SYSTEM{} and RAPLCap.}
% % \label{fig:code-examples}
% \end{figure}

\vspace{-1cm}
\section*{Demonstration and Results}

\SYSTEM{} meets soft performance goals, even for applications with noisy performance behavior, by adjusting the power cap (and thus power consumption):

{
\PAD
\centering
  \input{img/x264-phases.tex}    
  \captionof{figure}{Encoding video input exhibiting distinct phases while running \SYSTEM{}.}
  \label{fig:phases-x264}
\PAD
}

We evaluate \SYSTEM{} with 20 parallel applications and compare it to a sophisticated control-theoretic, model-driven software DVFS manager:

{
\PAD
\begin{minipage}{0.95\columnwidth}
\centering
\begin{tabular}{ccccc}
  &\multicolumn{2}{c}{\bf All Apps} & \multicolumn{2}{c}{\bf Memory-bound Apps} \\
  \textbf{Performance} & \textbf{CoPPer-0.0} & {\bf CoPPer-0.5} & \textbf{CoPPer-0.0} & {\bf CoPPer-0.5} \\
  \hline
  \hline
  $\mathsf{high}$    & 1.05  & 1.08 & 1.15  & 1.18 \\
  $\mathsf{medium}$  & 1.03  & 1.06 & 1.09  & 1.11 \\
  $\mathsf{low}$     & 1.02  & 1.04 & 1.06  & 1.08 \\
  \textbf{Average}   & \textbf{1.03}  & \textbf{1.06} & \textbf{1.10}  & \textbf{1.12} \\
  \hline
  \hline
\end{tabular}
\captionof{table}{\SYSTEM{} energy efficiency with gain limits of 0.0 and 0.5, normalized to the sophisticated DVFS controller (higher is better).}
\label{tbl:summary}
\PAD
\end{minipage}
}

% \begin{table}[t]

%----------------------------------------------------------------------------------------
%	CONCLUSIONS
%----------------------------------------------------------------------------------------
\color{SaddleBrown} % SaddleBrown color for the conclusions to make them stand out

% \section*{Conclusions}



\color{DarkSlateGray} % Set the color back to DarkSlateGray for the rest of the content

%----------------------------------------------------------------------------------------
%	FORTHCOMING RESEARCH
%----------------------------------------------------------------------------------------

%\section*{Forthcoming Research}



 %----------------------------------------------------------------------------------------
%	REFERENCES
%----------------------------------------------------------------------------------------

% \printbibliography
%\nocite{*} % Print all references regardless of whether they were cited in the poster or not
%\bibliographystyle{plain} % Plain referencing style
%\bibliography{seec}

%----------------------------------------------------------------------------------------
%	ACKNOWLEDGEMENTS
%----------------------------------------------------------------------------------------

\vspace{-1cm}
\section*{Acknowledgements}

\small
This research is supported by NSF (CCF-1439156, CNS-1526304, CCF-1823032, CNS-1764039).
Additional support comes from the Proteus project under the DARPA BRASS program and a DOE Early Career award.
ICAC attendance is supported in part by USC Information Sciences Institute.

%----------------------------------------------------------------------------------------

\end{multicols}

% \begin{minipage}[b]{\linewidth}
\begin{center}
\vspace{0.5cm}
% \Large \texttt{https://people.cs.uchicago.edu/{\raise.17ex\hbox{$\scriptstyle\mathtt{\sim}$}}ckimes/} \\
\Large \texttt{https://github.com/powercap/}
\end{center}
% \end{minipage}

\end{document}